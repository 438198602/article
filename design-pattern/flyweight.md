## 享元模式

享元模式是什么？它就是解决大量细粒度对象因为因为拥有重复的内容而造成内存开销过大的一种技术解决方案。

注：下文所有的`对象状态`均表示`对象属性`

### 使用场合

* 一个应用程序中使用了大量的相似对象
* 由于大量的对象，造成了很大的内存开销
* 对象的大多数的状态都可以转变为外部状态
* 剥离了对象的外部状态后，可以用相对较少的共享对象取代大量对象


### 内部状态和外部状态划分

* 内部状态存储在对象内部
* 内部状态可以被一些对象共享
* 内部状态独立于具体的场景，通常不会改变
* 外部状态取决于具体的场景，并且根据场景来变化，外部状态不能被共享

### 享元模式理解

在JavaScript中我们常见的用享元模式的地方为数据的处理和dom的操作。

* 数据处理：图书的管理
* dom操作：文件的上传

大部分场合见到的是二者的结合体。在后台管理系统中的数据信息列表的操作。

我们通常的做法是：

用工厂模式来创建一个类，该类保存的是对象的内部的共享状态，通过这个类来创建不同的分类对象，然后根据不同的场景为该对象添加外部状态。为了方便处理这些分类对象，我们需要保存这些对象的状态，这样就可以实现对每个对象的操作。

实现享元模式的关键就是内部状态和外部状态的分离。有多少种内部状态的组合就有多少个共享对象。

但是，我们要注意两种特殊的情况。第一种就是没有内部状态，但是我们仍然做了外部状态剥离的操作，这时的共享对象工厂就变成了单例工厂；第二种是没有外部状态，

代码的实现可以参考下面参考资料提供的链接。

### 参考资料

[https://www.cnblogs.com/TomXu/archive/2012/04/09/2379774.html](https://addyosmani.com/resources/essentialjsdesignpatterns/book/#detailflyweight)

[https://www.cnblogs.com/TomXu/archive/2012/04/09/2379774.html](https://www.cnblogs.com/TomXu/archive/2012/04/09/2379774.html)
